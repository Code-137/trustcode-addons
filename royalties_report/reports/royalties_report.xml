<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="paperformat_royalties" model="report.paperformat">
        <field name="name">Formato Relatório Royalties</field>
        <field name="default" eval="True" />
        <field name="orientation">Landscape</field>
        <field name="margin_top">30.0</field>
        <field name="margin_left">3.0</field>
        <field name="margin_right">3.0</field>
        <field name="margin_bottom">15.0</field>
        <field name="header_spacing">25</field>
    </record>

    <report id="royalties_report.action_royalties_report" model="account.voucher" report_type="qweb-pdf" string="Relatório de Royalties"
        name="royalties_report.royalties_report" file="royalties_report.royalties_report" paperformat="paperformat_royalties"
    />

    <template id="royalties_report_document">
        <t t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})" />
        <div class="header">
            <h1 style="text-align: center;"><span t-field="docs.company_id" /></h1>
            <h4 style="text-align: center;"><span>Prestação de Contas de Direitos Autorais</span></h4>
        </div>
        <div class="page">
            <t t-foreach="o.line_ids" t-as="l">
                <div class="row">
                    <div class="col-xs-12" style="text-align: right;">
                        <label>Royalties</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <label>Period:</label>
                    </div>
                    <div class="col-xs-6">
                        <span></span>
                    </div>
                </div>
                <div class="row" style="border-bottom: 1px solid grey;">
                    <div class="col-xs-6">
                        <label>Publication Month:</label>
                    </div>
                    <div class="col-xs-6">
                        <span></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <label>Author:</label>
                    </div>
                    <div class="col-xs-6">
                        <span t-field="l.voucher_id.partner_id"></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <label>Original title:</label>
                    </div>
                    <div class="col-xs-6">
                        <span t-field="l.product_id.name"></span>
                    </div>
                </div>
                <div class="row" style="border-bottom: 1px solid grey;">
                    <div class="col-xs-6">
                        <label>Portuguese title:</label>
                    </div>
                    <div class="col-xs-6">
                        <span t-field="l.product_id.name"></span>
                    </div>
                </div>
                <div class="row" style="border-bottom: 1px solid grey;">
                    <div class="col-xs-6">
                        <label>Sales in the period:</label>
                    </div>
                    <div class="col-xs-6">
                        <span></span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">
                        <label>Invoice</label>
                    </div>
                    <div class="col-xs-3" style="text-align: center;">
                        <label>Quantity</label>
                    </div>
                    <div class="col-xs-2">
                        <label>Price</label>
                    </div>
                    <div class="col-xs-1">
                        <label>%</label>
                    </div>
                    <div class="col-xs-3" style="text-align: center;">
                        <label>Royalties earned</label>
                    </div>
                </div>
                <t t-foreach="royalties_lines" t-as="r">
                    <t t-if="r.product_id == l.product_id">
                        <div class="row" style="border-bottom: 1px solid grey;">
                            <div class="col-xs-3" style="text-align: left;">
                                <span t-field="r.inv_line_id.invoice_id.number"></span>
                            </div>
                            <div class="col-xs-3" style="text-align: center;">
                                <t t-if="r.is_devol">-</t>
                                <span t-field="r.inv_line_id.quantity"></span>
                            </div>
                            <div class="col-xs-2" style="text-align: left;">
                                <span t-field="r.inv_line_id.price_subtotal"></span>
                            </div>
                            <div class="col-xs-1" style="text-align: left;">
                                <span></span>
                            </div>
                            <div class="col-xs-3" style="text-align: center;">
                                <t t-if="r.is_devol">-</t>
                                <t t-set="royalties_earned" t-value="r.inv_line_id.price_subtotal * r.inv_line_id.quantity" /> R$
                                <span t-esc="royalties_earned"></span>
                            </div>
                        </div>
                    </t>
                </t>
                <div class="row" style="border-bottom: 1px solid grey;">
                    <div class="col-xs-6">
                        <label>Total:</label>
                    </div>
                    <div class="col-xs-6">
                        <span></span>
                    </div>
                </div>
                <div class="row" style="border-bottom: 1px solid grey;">
                    <div class="col-xs-6">
                        <label>Advance or Balance:</label>
                    </div>
                    <div class="col-xs-6">
                        <span></span>
                    </div>
                </div>
                <div class="row" style="border-bottom: 1px solid grey;">
                    <div class="col-xs-6">
                        <label>Amount due:</label>
                    </div>
                    <div class="col-xs-6">
                        <span></span>
                    </div>
                </div>
            </t>
        </div>
    </template>

    <template id="royalties_report">
        <t t-call="report.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="royalties_report.royalties_report_document" t-lang="o.partner_id.lang" />
            </t>
        </t>
    </template>
</odoo>